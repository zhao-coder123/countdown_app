# ğŸš€ Flutterå€’è®¡æ—¶åº”ç”¨é¡¹ç›®æ­å»ºæŒ‡å—

æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä»é›¶å¼€å§‹æ­å»º"åœ†æ—¶é—´"Flutterå€’è®¡æ—¶åº”ç”¨ï¼ŒåŒ…æ‹¬ç¯å¢ƒé…ç½®ã€é¡¹ç›®åˆå§‹åŒ–ã€æ ¸å¿ƒåŠŸèƒ½å®ç°ç­‰å®Œæ•´æµç¨‹ã€‚

## ğŸ“‹ ç›®å½•

- [ç¯å¢ƒå‡†å¤‡](#-ç¯å¢ƒå‡†å¤‡)
- [é¡¹ç›®åˆå§‹åŒ–](#-é¡¹ç›®åˆå§‹åŒ–)
- [é¡¹ç›®æ¶æ„è®¾è®¡](#-é¡¹ç›®æ¶æ„è®¾è®¡)
- [æ ¸å¿ƒåŠŸèƒ½å®ç°](#-æ ¸å¿ƒåŠŸèƒ½å®ç°)
- [UIç•Œé¢è®¾è®¡](#-uiç•Œé¢è®¾è®¡)
- [æ•°æ®ç®¡ç†](#-æ•°æ®ç®¡ç†)
- [çŠ¶æ€ç®¡ç†](#-çŠ¶æ€ç®¡ç†)
- [å›¾æ ‡è®¾è®¡](#-å›¾æ ‡è®¾è®¡)
- [æ„å»ºå‘å¸ƒ](#-æ„å»ºå‘å¸ƒ)
- [å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)

## ğŸ›  ç¯å¢ƒå‡†å¤‡

### 1. å®‰è£…Flutter SDK

**Windowsç¯å¢ƒ:**
```bash
# 1. ä¸‹è½½Flutter SDK
# è®¿é—® https://flutter.dev/docs/get-started/install/windows
# ä¸‹è½½æœ€æ–°ç¨³å®šç‰ˆæœ¬

# 2. è§£å‹åˆ°ç›®æ ‡ç›®å½•
# ä¾‹å¦‚: C:\flutter

# 3. æ·»åŠ ç¯å¢ƒå˜é‡
# å°† C:\flutter\bin æ·»åŠ åˆ° PATH

# 4. éªŒè¯å®‰è£…
flutter doctor
```

**macOSç¯å¢ƒ:**
```bash
# ä½¿ç”¨Homebrewå®‰è£…
brew install flutter

# æˆ–è€…æ‰‹åŠ¨ä¸‹è½½
# è®¿é—® https://flutter.dev/docs/get-started/install/macos

# éªŒè¯å®‰è£…
flutter doctor
```

### 2. é…ç½®å¼€å‘ç¯å¢ƒ

**Android Studioè®¾ç½®:**
```bash
# 1. ä¸‹è½½å¹¶å®‰è£…Android Studio
# 2. å®‰è£…Flutterå’ŒDartæ’ä»¶
# 3. é…ç½®Android SDK
flutter doctor --android-licenses
```

**VS Codeè®¾ç½®:**
```bash
# å®‰è£…å¿…è¦çš„æ‰©å±•
# - Flutter
# - Dart
# - Flutter Widget Snippets
```

### 3. éªŒè¯ç¯å¢ƒ
```bash
# æ£€æŸ¥ç¯å¢ƒé…ç½®
flutter doctor -v

# åˆ›å»ºæµ‹è¯•é¡¹ç›®éªŒè¯
flutter create test_app
cd test_app
flutter run
```

## ğŸ¯ é¡¹ç›®åˆå§‹åŒ–

### 1. åˆ›å»ºé¡¹ç›®
```bash
# åˆ›å»ºæ–°çš„Flutteré¡¹ç›®
flutter create countdown_app
cd countdown_app

# æ£€æŸ¥é¡¹ç›®ç»“æ„
ls -la
```

### 2. é…ç½®pubspec.yaml
```yaml
name: countdown_app
description: "ç²¾ç¾çš„Flutterå€’è®¡æ—¶åº”ç”¨"
version: 1.0.0+1

environment:
  sdk: '>=3.8.0 <4.0.0'
  flutter: ">=3.32.0"

dependencies:
  flutter:
    sdk: flutter
  flutter_localizations:
    sdk: flutter
  
  # çŠ¶æ€ç®¡ç†
  provider: ^6.1.2
  
  # æ•°æ®å­˜å‚¨
  sqflite: ^2.4.1
  shared_preferences: ^2.3.2
  path: ^1.9.0
  
  # UIå¢å¼º
  google_fonts: ^6.2.1
  flutter_colorpicker: ^1.1.0
  animations: ^2.0.11
  animated_text_kit: ^4.2.2
  
  # å›½é™…åŒ–
  intl: ^0.19.0
  
  # å…¶ä»–å·¥å…·
  cupertino_icons: ^1.0.8

dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^5.0.0
  flutter_launcher_icons: ^0.14.1

flutter:
  uses-material-design: true
  generate: true
  
  assets:
    - assets/icon/
    - assets/images/
```

### 3. å®‰è£…ä¾èµ–
```bash
flutter pub get
```

## ğŸ— é¡¹ç›®æ¶æ„è®¾è®¡

### 1. æ–‡ä»¶å¤¹ç»“æ„
```
lib/
â”œâ”€â”€ main.dart                 # åº”ç”¨å…¥å£
â”œâ”€â”€ l10n/                     # å›½é™…åŒ–æ–‡ä»¶
â”‚   â”œâ”€â”€ app_en.arb
â”‚   â”œâ”€â”€ app_zh.arb
â”‚   â””â”€â”€ app_localizations.dart
â”œâ”€â”€ models/                   # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ countdown_model.dart
â”œâ”€â”€ providers/                # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ countdown_provider.dart
â”‚   â”œâ”€â”€ theme_provider.dart
â”‚   â””â”€â”€ locale_provider.dart
â”œâ”€â”€ screens/                  # é¡µé¢
â”‚   â”œâ”€â”€ main_screen.dart
â”‚   â”œâ”€â”€ home_screen.dart
â”‚   â”œâ”€â”€ add_screen.dart
â”‚   â”œâ”€â”€ detail_screen.dart
â”‚   â”œâ”€â”€ discover_screen.dart
â”‚   â”œâ”€â”€ edit_screen.dart
â”‚   â””â”€â”€ settings_screen.dart
â”œâ”€â”€ widgets/                  # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ countdown_card.dart
â”‚   â””â”€â”€ chinese_date_picker.dart
â””â”€â”€ services/                 # æœåŠ¡å±‚
    â”œâ”€â”€ database_service.dart
    â””â”€â”€ export_service.dart
```

### 2. åˆ›å»ºåŸºç¡€æ–‡ä»¶å¤¹
```bash
mkdir -p lib/{models,providers,screens,widgets,services,l10n}
```

## ğŸ’» æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. æ•°æ®æ¨¡å‹è®¾è®¡

**åˆ›å»º `lib/models/countdown_model.dart`:**
```dart
class CountdownModel {
  final int? id;
  final String title;
  final String description;
  final DateTime targetDate;
  final DateTime createdAt;
  final String eventType;
  final int themeIndex;
  final bool isCompleted;

  CountdownModel({
    this.id,
    required this.title,
    required this.description,
    required this.targetDate,
    required this.createdAt,
    required this.eventType,
    this.themeIndex = 0,
    this.isCompleted = false,
  });

  // è®¡ç®—å‰©ä½™æ—¶é—´
  Duration get remainingDuration {
    final now = DateTime.now();
    if (targetDate.isBefore(now)) {
      return Duration.zero;
    }
    return targetDate.difference(now);
  }

  // æ˜¯å¦å·²è¿‡æœŸ
  bool get isExpired => remainingDuration == Duration.zero;

  // JSONåºåˆ—åŒ–
  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'title': title,
      'description': description,
      'targetDate': targetDate.toIso8601String(),
      'createdAt': createdAt.toIso8601String(),
      'eventType': eventType,
      'themeIndex': themeIndex,
      'isCompleted': isCompleted ? 1 : 0,
    };
  }

  factory CountdownModel.fromJson(Map<String, dynamic> json) {
    return CountdownModel(
      id: json['id'],
      title: json['title'],
      description: json['description'],
      targetDate: DateTime.parse(json['targetDate']),
      createdAt: DateTime.parse(json['createdAt']),
      eventType: json['eventType'],
      themeIndex: json['themeIndex'] ?? 0,
      isCompleted: json['isCompleted'] == 1,
    );
  }

  CountdownModel copyWith({
    int? id,
    String? title,
    String? description,
    DateTime? targetDate,
    DateTime? createdAt,
    String? eventType,
    int? themeIndex,
    bool? isCompleted,
  }) {
    return CountdownModel(
      id: id ?? this.id,
      title: title ?? this.title,
      description: description ?? this.description,
      targetDate: targetDate ?? this.targetDate,
      createdAt: createdAt ?? this.createdAt,
      eventType: eventType ?? this.eventType,
      themeIndex: themeIndex ?? this.themeIndex,
      isCompleted: isCompleted ?? this.isCompleted,
    );
  }
}
```

### 2. æ•°æ®åº“æœåŠ¡

**åˆ›å»º `lib/services/database_service.dart`:**
```dart
import 'package:sqflite/sqflite.dart';
import 'package:path/path.dart';
import '../models/countdown_model.dart';

class DatabaseService {
  static final DatabaseService _instance = DatabaseService._internal();
  factory DatabaseService() => _instance;
  DatabaseService._internal();

  static Database? _database;

  Future<Database> get database async {
    if (_database != null) return _database!;
    _database = await _initDatabase();
    return _database!;
  }

  Future<Database> _initDatabase() async {
    final dbPath = await getDatabasesPath();
    final path = join(dbPath, 'countdown.db');

    return await openDatabase(
      path,
      version: 1,
      onCreate: _createTables,
    );
  }

  Future<void> _createTables(Database db, int version) async {
    await db.execute('''
      CREATE TABLE countdowns (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        title TEXT NOT NULL,
        description TEXT NOT NULL,
        targetDate TEXT NOT NULL,
        createdAt TEXT NOT NULL,
        eventType TEXT NOT NULL,
        themeIndex INTEGER DEFAULT 0,
        isCompleted INTEGER DEFAULT 0
      )
    ''');
  }

  // æ’å…¥å€’è®¡æ—¶
  Future<int> insertCountdown(CountdownModel countdown) async {
    final db = await database;
    return await db.insert('countdowns', countdown.toJson());
  }

  // è·å–æ‰€æœ‰å€’è®¡æ—¶
  Future<List<CountdownModel>> getAllCountdowns() async {
    final db = await database;
    final maps = await db.query('countdowns', orderBy: 'targetDate ASC');
    return maps.map((map) => CountdownModel.fromJson(map)).toList();
  }

  // æ›´æ–°å€’è®¡æ—¶
  Future<int> updateCountdown(CountdownModel countdown) async {
    final db = await database;
    return await db.update(
      'countdowns',
      countdown.toJson(),
      where: 'id = ?',
      whereArgs: [countdown.id],
    );
  }

  // åˆ é™¤å€’è®¡æ—¶
  Future<int> deleteCountdown(int id) async {
    final db = await database;
    return await db.delete(
      'countdowns',
      where: 'id = ?',
      whereArgs: [id],
    );
  }

  // æ ¹æ®ç±»å‹æŸ¥è¯¢
  Future<List<CountdownModel>> getCountdownsByType(String eventType) async {
    final db = await database;
    final maps = await db.query(
      'countdowns',
      where: 'eventType = ?',
      whereArgs: [eventType],
      orderBy: 'targetDate ASC',
    );
    return maps.map((map) => CountdownModel.fromJson(map)).toList();
  }
}
```

### 3. çŠ¶æ€ç®¡ç†

**åˆ›å»º `lib/providers/countdown_provider.dart`:**
```dart
import 'package:flutter/material.dart';
import '../models/countdown_model.dart';
import '../services/database_service.dart';

class CountdownProvider with ChangeNotifier {
  final DatabaseService _dbService = DatabaseService();
  List<CountdownModel> _countdowns = [];
  bool _isLoading = false;

  List<CountdownModel> get countdowns => _countdowns;
  bool get isLoading => _isLoading;

  // è·å–æœªè¿‡æœŸçš„å€’è®¡æ—¶
  List<CountdownModel> get activeCountdowns =>
      _countdowns.where((countdown) => !countdown.isExpired).toList();

  // è·å–å·²è¿‡æœŸçš„å€’è®¡æ—¶
  List<CountdownModel> get expiredCountdowns =>
      _countdowns.where((countdown) => countdown.isExpired).toList();

  // åŠ è½½æ‰€æœ‰å€’è®¡æ—¶
  Future<void> loadCountdowns() async {
    _isLoading = true;
    notifyListeners();

    try {
      _countdowns = await _dbService.getAllCountdowns();
    } catch (e) {
      debugPrint('Error loading countdowns: $e');
    } finally {
      _isLoading = false;
      notifyListeners();
    }
  }

  // æ·»åŠ å€’è®¡æ—¶
  Future<void> addCountdown(CountdownModel countdown) async {
    try {
      final id = await _dbService.insertCountdown(countdown);
      final newCountdown = countdown.copyWith(id: id);
      _countdowns.add(newCountdown);
      _sortCountdowns();
      notifyListeners();
    } catch (e) {
      debugPrint('Error adding countdown: $e');
      rethrow;
    }
  }

  // æ›´æ–°å€’è®¡æ—¶
  Future<void> updateCountdown(CountdownModel countdown) async {
    try {
      await _dbService.updateCountdown(countdown);
      final index = _countdowns.indexWhere((c) => c.id == countdown.id);
      if (index != -1) {
        _countdowns[index] = countdown;
        _sortCountdowns();
        notifyListeners();
      }
    } catch (e) {
      debugPrint('Error updating countdown: $e');
      rethrow;
    }
  }

  // åˆ é™¤å€’è®¡æ—¶
  Future<void> deleteCountdown(int id) async {
    try {
      await _dbService.deleteCountdown(id);
      _countdowns.removeWhere((countdown) => countdown.id == id);
      notifyListeners();
    } catch (e) {
      debugPrint('Error deleting countdown: $e');
      rethrow;
    }
  }

  // æŒ‰æ—¥æœŸæ’åº
  void _sortCountdowns() {
    _countdowns.sort((a, b) => a.targetDate.compareTo(b.targetDate));
  }

  // æ ¹æ®ç±»å‹ç­›é€‰
  List<CountdownModel> getCountdownsByType(String eventType) {
    return _countdowns.where((c) => c.eventType == eventType).toList();
  }
}
```

## ğŸ¨ UIç•Œé¢è®¾è®¡

### 1. ä¸»é¢˜ç®¡ç†

**åˆ›å»º `lib/providers/theme_provider.dart`:**
```dart
import 'package:flutter/material.dart';
import 'package:shared_preferences/shared_preferences.dart';

class ThemeProvider with ChangeNotifier {
  bool _isDarkMode = false;
  int _currentThemeIndex = 0;

  bool get isDarkMode => _isDarkMode;
  int get currentThemeIndex => _currentThemeIndex;

  // æ¸å˜ä¸»é¢˜è‰²å½©
  static const List<List<Color>> gradientThemes = [
    [Color(0xFF667eea), Color(0xFF764ba2)], // ç´«è“æ¸å˜
    [Color(0xFFf093fb), Color(0xFFf5576c)], // ç²‰çº¢æ¸å˜
    [Color(0xFF4facfe), Color(0xFF00f2fe)], // è“é’æ¸å˜
    [Color(0xFF43e97b), Color(0xFF38f9d7)], // ç»¿é’æ¸å˜
    [Color(0xFFfa709a), Color(0xFFfee140)], // ç²‰é»„æ¸å˜
    [Color(0xFFa8edea), Color(0xFFfed6e3)], // é’ç²‰æ¸å˜
    [Color(0xFFffecd2), Color(0xFFfcb69f)], // æ©™æ¡ƒæ¸å˜
    [Color(0xFFd299c2), Color(0xFFfef9d7)], // ç´«ç±³æ¸å˜
    [Color(0xFF89f7fe), Color(0xFF66a6ff)], // é’è“æ¸å˜
    [Color(0xFFfdbb2d), Color(0xFF22c1c3)], // é»„é’æ¸å˜
  ];

  LinearGradient get currentGradient {
    final colors = gradientThemes[_currentThemeIndex];
    return LinearGradient(
      begin: Alignment.topLeft,
      end: Alignment.bottomRight,
      colors: colors,
    );
  }

  ThemeData get lightTheme {
    return ThemeData(
      useMaterial3: true,
      brightness: Brightness.light,
      colorScheme: ColorScheme.fromSeed(
        seedColor: gradientThemes[_currentThemeIndex][0],
        brightness: Brightness.light,
      ),
      appBarTheme: const AppBarTheme(
        elevation: 0,
        centerTitle: true,
      ),
    );
  }

  ThemeData get darkTheme {
    return ThemeData(
      useMaterial3: true,
      brightness: Brightness.dark,
      colorScheme: ColorScheme.fromSeed(
        seedColor: gradientThemes[_currentThemeIndex][0],
        brightness: Brightness.dark,
      ),
      appBarTheme: const AppBarTheme(
        elevation: 0,
        centerTitle: true,
      ),
    );
  }

  Future<void> toggleTheme() async {
    _isDarkMode = !_isDarkMode;
    await _savePreferences();
    notifyListeners();
  }

  Future<void> setThemeIndex(int index) async {
    if (index >= 0 && index < gradientThemes.length) {
      _currentThemeIndex = index;
      await _savePreferences();
      notifyListeners();
    }
  }

  Future<void> loadPreferences() async {
    final prefs = await SharedPreferences.getInstance();
    _isDarkMode = prefs.getBool('isDarkMode') ?? false;
    _currentThemeIndex = prefs.getInt('themeIndex') ?? 0;
    notifyListeners();
  }

  Future<void> _savePreferences() async {
    final prefs = await SharedPreferences.getInstance();
    await prefs.setBool('isDarkMode', _isDarkMode);
    await prefs.setInt('themeIndex', _currentThemeIndex);
  }
}
```

### 2. åœ†å½¢è¿›åº¦ç»„ä»¶

**åˆ›å»º `lib/widgets/countdown_card.dart`:**
```dart
import 'package:flutter/material.dart';
import 'dart:math' as math;
import '../models/countdown_model.dart';

class CountdownCard extends StatefulWidget {
  final CountdownModel countdown;
  final VoidCallback? onTap;

  const CountdownCard({
    Key? key,
    required this.countdown,
    this.onTap,
  }) : super(key: key);

  @override
  State<CountdownCard> createState() => _CountdownCardState();
}

class _CountdownCardState extends State<CountdownCard>
    with TickerProviderStateMixin {
  late AnimationController _animationController;
  late Animation<double> _scaleAnimation;

  @override
  void initState() {
    super.initState();
    _animationController = AnimationController(
      duration: const Duration(milliseconds: 200),
      vsync: this,
    );
    _scaleAnimation = Tween<double>(
      begin: 1.0,
      end: 0.95,
    ).animate(CurvedAnimation(
      parent: _animationController,
      curve: Curves.easeInOut,
    ));
  }

  @override
  void dispose() {
    _animationController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return GestureDetector(
      onTapDown: (_) => _animationController.forward(),
      onTapUp: (_) => _animationController.reverse(),
      onTapCancel: () => _animationController.reverse(),
      onTap: widget.onTap,
      child: AnimatedBuilder(
        animation: _scaleAnimation,
        builder: (context, child) {
          return Transform.scale(
            scale: _scaleAnimation.value,
            child: Container(
              margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
              padding: const EdgeInsets.all(20),
              decoration: BoxDecoration(
                borderRadius: BorderRadius.circular(20),
                gradient: _getGradient(),
                boxShadow: [
                  BoxShadow(
                    color: Colors.black.withOpacity(0.1),
                    blurRadius: 10,
                    offset: const Offset(0, 5),
                  ),
                ],
              ),
              child: Column(
                children: [
                  _buildHeader(),
                  const SizedBox(height: 20),
                  _buildCircularProgress(),
                  const SizedBox(height: 20),
                  _buildTimeDisplay(),
                ],
              ),
            ),
          );
        },
      ),
    );
  }

  Widget _buildHeader() {
    return Row(
      children: [
        _buildEventIcon(),
        const SizedBox(width: 12),
        Expanded(
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Text(
                widget.countdown.title,
                style: const TextStyle(
                  fontSize: 18,
                  fontWeight: FontWeight.bold,
                  color: Colors.white,
                ),
                maxLines: 1,
                overflow: TextOverflow.ellipsis,
              ),
              if (widget.countdown.description.isNotEmpty) ...[
                const SizedBox(height: 4),
                Text(
                  widget.countdown.description,
                  style: TextStyle(
                    fontSize: 14,
                    color: Colors.white.withOpacity(0.8),
                  ),
                  maxLines: 1,
                  overflow: TextOverflow.ellipsis,
                ),
              ],
            ],
          ),
        ),
      ],
    );
  }

  Widget _buildEventIcon() {
    IconData iconData;
    switch (widget.countdown.eventType) {
      case 'ç”Ÿæ—¥':
        iconData = Icons.cake;
        break;
      case 'çºªå¿µæ—¥':
        iconData = Icons.favorite;
        break;
      case 'èŠ‚æ—¥':
        iconData = Icons.celebration;
        break;
      default:
        iconData = Icons.event;
    }

    return Container(
      padding: const EdgeInsets.all(8),
      decoration: BoxDecoration(
        color: Colors.white.withOpacity(0.2),
        borderRadius: BorderRadius.circular(12),
      ),
      child: Icon(
        iconData,
        color: Colors.white,
        size: 24,
      ),
    );
  }

  Widget _buildCircularProgress() {
    final now = DateTime.now();
    final total = widget.countdown.targetDate.difference(widget.countdown.createdAt);
    final remaining = widget.countdown.targetDate.difference(now);
    
    double progress = 0.0;
    if (total.inSeconds > 0) {
      progress = math.max(0.0, math.min(1.0, 
        (total.inSeconds - remaining.inSeconds) / total.inSeconds));
    }

    return SizedBox(
      width: 120,
      height: 120,
      child: CustomPaint(
        painter: CircularProgressPainter(
          progress: widget.countdown.isExpired ? 1.0 : progress,
          backgroundColor: Colors.white.withOpacity(0.3),
          progressColor: Colors.white,
          strokeWidth: 8,
        ),
        child: Center(
          child: Column(
            mainAxisSize: MainAxisSize.min,
            children: [
              Text(
                widget.countdown.isExpired ? 'å·²ç»“æŸ' : 'å‰©ä½™',
                style: TextStyle(
                  fontSize: 12,
                  color: Colors.white.withOpacity(0.8),
                ),
              ),
              const SizedBox(height: 4),
              Text(
                widget.countdown.isExpired 
                  ? '00:00:00'
                  : _formatDuration(widget.countdown.remainingDuration),
                style: const TextStyle(
                  fontSize: 16,
                  fontWeight: FontWeight.bold,
                  color: Colors.white,
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }

  Widget _buildTimeDisplay() {
    final remaining = widget.countdown.remainingDuration;
    
    return Row(
      mainAxisAlignment: MainAxisAlignment.spaceEvenly,
      children: [
        _buildTimeUnit('å¤©', remaining.inDays.toString()),
        _buildTimeUnit('æ—¶', (remaining.inHours % 24).toString()),
        _buildTimeUnit('åˆ†', (remaining.inMinutes % 60).toString()),
        _buildTimeUnit('ç§’', (remaining.inSeconds % 60).toString()),
      ],
    );
  }

  Widget _buildTimeUnit(String label, String value) {
    return Column(
      children: [
        Text(
          value,
          style: const TextStyle(
            fontSize: 20,
            fontWeight: FontWeight.bold,
            color: Colors.white,
          ),
        ),
        Text(
          label,
          style: TextStyle(
            fontSize: 12,
            color: Colors.white.withOpacity(0.8),
          ),
        ),
      ],
    );
  }

  LinearGradient _getGradient() {
    // è¿™é‡Œå¯ä»¥æ ¹æ®ä¸»é¢˜ç´¢å¼•è¿”å›ä¸åŒçš„æ¸å˜
    final gradients = [
      [const Color(0xFF667eea), const Color(0xFF764ba2)],
      [const Color(0xFFf093fb), const Color(0xFFf5576c)],
      [const Color(0xFF4facfe), const Color(0xFF00f2fe)],
      // ... æ›´å¤šæ¸å˜
    ];
    
    final colors = gradients[widget.countdown.themeIndex % gradients.length];
    return LinearGradient(
      begin: Alignment.topLeft,
      end: Alignment.bottomRight,
      colors: colors,
    );
  }

  String _formatDuration(Duration duration) {
    final hours = duration.inHours.toString().padLeft(2, '0');
    final minutes = (duration.inMinutes % 60).toString().padLeft(2, '0');
    final seconds = (duration.inSeconds % 60).toString().padLeft(2, '0');
    return '$hours:$minutes:$seconds';
  }
}

class CircularProgressPainter extends CustomPainter {
  final double progress;
  final Color backgroundColor;
  final Color progressColor;
  final double strokeWidth;

  CircularProgressPainter({
    required this.progress,
    required this.backgroundColor,
    required this.progressColor,
    required this.strokeWidth,
  });

  @override
  void paint(Canvas canvas, Size size) {
    final center = Offset(size.width / 2, size.height / 2);
    final radius = (size.width - strokeWidth) / 2;

    // ç»˜åˆ¶èƒŒæ™¯åœ†ç¯
    final backgroundPaint = Paint()
      ..color = backgroundColor
      ..strokeWidth = strokeWidth
      ..style = PaintingStyle.stroke
      ..strokeCap = StrokeCap.round;

    canvas.drawCircle(center, radius, backgroundPaint);

    // ç»˜åˆ¶è¿›åº¦åœ†ç¯
    final progressPaint = Paint()
      ..color = progressColor
      ..strokeWidth = strokeWidth
      ..style = PaintingStyle.stroke
      ..strokeCap = StrokeCap.round;

    final sweepAngle = 2 * math.pi * progress;
    canvas.drawArc(
      Rect.fromCircle(center: center, radius: radius),
      -math.pi / 2, // ä»é¡¶éƒ¨å¼€å§‹
      sweepAngle,
      false,
      progressPaint,
    );
  }

  @override
  bool shouldRepaint(covariant CustomPainter oldDelegate) {
    return oldDelegate != this;
  }
}
```

## ğŸ“± å›¾æ ‡è®¾è®¡

### 1. åˆ›å»ºå›¾æ ‡ç”Ÿæˆå™¨

**åˆ›å»º `icon_generator.html`:**
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>åº”ç”¨å›¾æ ‡ç”Ÿæˆå™¨</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        canvas {
            border: 2px solid #eee;
            border-radius: 15px;
            margin: 20px auto;
            display: block;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 10px;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        .preview {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        .size-label {
            text-align: center;
            margin-top: 5px;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ• åœ†æ—¶é—´ - åº”ç”¨å›¾æ ‡ç”Ÿæˆå™¨</h1>
        
        <canvas id="iconCanvas" width="1024" height="1024"></canvas>
        
        <div class="controls">
            <button onclick="generateIcon()">ğŸ¨ é‡æ–°ç”Ÿæˆå›¾æ ‡</button>
            <button onclick="downloadAllSizes()">ğŸ“¦ ç”Ÿæˆæ‰€æœ‰å°ºå¯¸</button>
        </div>
        
        <div class="preview" id="preview"></div>
    </div>

    <script>
        function generateIcon() {
            const canvas = document.getElementById('iconCanvas');
            const ctx = canvas.getContext('2d');
            
            // æ¸…ç©ºç”»å¸ƒ
            ctx.clearRect(0, 0, 1024, 1024);
            
            // ç»˜åˆ¶æ¸å˜èƒŒæ™¯
            const gradient = ctx.createLinearGradient(0, 0, 1024, 1024);
            gradient.addColorStop(0, '#667eea');
            gradient.addColorStop(1, '#764ba2');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 1024, 1024);
            
            // ç»˜åˆ¶ä¸»åœ†ç¯
            const centerX = 512;
            const centerY = 512;
            const radius = 300;
            
            // å¤–åœ†ç¯èƒŒæ™¯
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 40;
            ctx.stroke();
            
            // è¿›åº¦åœ†ç¯
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, -Math.PI/2, Math.PI);
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.lineWidth = 40;
            ctx.lineCap = 'round';
            ctx.stroke();
            
            // ç»˜åˆ¶æ—¶é’ŸæŒ‡é’ˆ
            drawClockHands(ctx, centerX, centerY);
            
            // ç»˜åˆ¶ä¸­å¿ƒåœ†
            ctx.beginPath();
            ctx.arc(centerX, centerY, 80, 0, 2 * Math.PI);
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.fill();
            
            // ç»˜åˆ¶æ—¶é—´æ–‡å­—
            ctx.fillStyle = '#764ba2';
            ctx.font = 'bold 60px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('æ—¶é—´', centerX, centerY + 20);
            
            // ç”Ÿæˆé¢„è§ˆ
            generatePreviews();
        }
        
        function drawClockHands(ctx, centerX, centerY) {
            const now = new Date();
            const hours = now.getHours() % 12;
            const minutes = now.getMinutes();
            
            // æ—¶é’ˆ
            const hourAngle = (hours * 30 + minutes * 0.5) * Math.PI / 180 - Math.PI / 2;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(
                centerX + Math.cos(hourAngle) * 100,
                centerY + Math.sin(hourAngle) * 100
            );
            ctx.strokeStyle = '#764ba2';
            ctx.lineWidth = 12;
            ctx.lineCap = 'round';
            ctx.stroke();
            
            // åˆ†é’ˆ
            const minuteAngle = minutes * 6 * Math.PI / 180 - Math.PI / 2;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(
                centerX + Math.cos(minuteAngle) * 140,
                centerY + Math.sin(minuteAngle) * 140
            );
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 8;
            ctx.lineCap = 'round';
            ctx.stroke();
        }
        
        function generatePreviews() {
            const sizes = [192, 144, 96, 72, 48];
            const preview = document.getElementById('preview');
            preview.innerHTML = '';
            
            sizes.forEach(size => {
                const previewCanvas = document.createElement('canvas');
                previewCanvas.width = size;
                previewCanvas.height = size;
                previewCanvas.style.border = '1px solid #ddd';
                previewCanvas.style.borderRadius = '8px';
                
                const previewCtx = previewCanvas.getContext('2d');
                const mainCanvas = document.getElementById('iconCanvas');
                previewCtx.drawImage(mainCanvas, 0, 0, size, size);
                
                const container = document.createElement('div');
                container.appendChild(previewCanvas);
                
                const label = document.createElement('div');
                label.className = 'size-label';
                label.textContent = `${size}Ã—${size}`;
                container.appendChild(label);
                
                preview.appendChild(container);
            });
        }
        
        function downloadAllSizes() {
            const sizes = [
                {name: 'app_icon', size: 1024},
                {name: 'app_icon_foreground', size: 1024}
            ];
            
            sizes.forEach(item => {
                const canvas = document.createElement('canvas');
                canvas.width = item.size;
                canvas.height = item.size;
                const ctx = canvas.getContext('2d');
                
                const mainCanvas = document.getElementById('iconCanvas');
                ctx.drawImage(mainCanvas, 0, 0, item.size, item.size);
                
                // ä¸‹è½½
                const link = document.createElement('a');
                link.download = `${item.name}.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
        }
        
        // é¡µé¢åŠ è½½æ—¶ç”Ÿæˆå›¾æ ‡
        window.onload = generateIcon;
    </script>
</body>
</html>
```

### 2. é…ç½®å›¾æ ‡ç”Ÿæˆå™¨

**åˆ›å»º `flutter_launcher_icons.yaml` é…ç½®:**
```yaml
flutter_launcher_icons:
  android: "launcher_icon"
  ios: true
  image_path: "assets/icon/app_icon.png"
  adaptive_icon_background: "#667eea"
  adaptive_icon_foreground: "assets/icon/app_icon_foreground.png"
  
  # ç§»é™¤ä¸å¿…è¦çš„é»˜è®¤å›¾æ ‡
  remove_alpha_ios: true
  
  # Webå›¾æ ‡
  web:
    generate: true
    image_path: "assets/icon/app_icon.png"
  
  # Windowså›¾æ ‡
  windows:
    generate: true
    image_path: "assets/icon/app_icon.png"
    icon_size: 48
  
  # macOSå›¾æ ‡
  macos:
    generate: true
    image_path: "assets/icon/app_icon.png"
```

### 3. ç”Ÿæˆå›¾æ ‡å‘½ä»¤
```bash
# ç”Ÿæˆåº”ç”¨å›¾æ ‡
flutter pub run flutter_launcher_icons:main

# å¦‚æœæœ‰é”™è¯¯ï¼Œå…ˆæ¸…ç†å†é‡æ–°ç”Ÿæˆ
flutter clean
flutter pub get
flutter pub run flutter_launcher_icons:main
```

## ğŸ“¦ æ„å»ºå‘å¸ƒ

### 1. Android APKæ„å»º

**é…ç½®ç­¾å (å¯é€‰):**
```bash
# ç”Ÿæˆç­¾åå¯†é’¥
keytool -genkey -v -keystore ~/upload-keystore.jks -keyalg RSA -keysize 2048 -validity 10000 -alias upload

# åˆ›å»º android/key.properties
echo "storePassword=your_password
keyPassword=your_password
keyAlias=upload
storeFile=../upload-keystore.jks" > android/key.properties
```

**ä¿®æ”¹ `android/app/build.gradle`:**
```gradle
// åœ¨ android å—å‰æ·»åŠ 
def keystoreProperties = new Properties()
def keystorePropertiesFile = rootProject.file('key.properties')
if (keystorePropertiesFile.exists()) {
    keystoreProperties.load(new FileInputStream(keystorePropertiesFile))
}

android {
    compileSdkVersion flutter.compileSdkVersion
    
    defaultConfig {
        applicationId "com.daojish.countdown_app"
        minSdkVersion flutter.minSdkVersion
        targetSdkVersion flutter.targetSdkVersion
        versionCode flutterVersionCode.toInteger()
        versionName flutterVersionName
    }
    
    signingConfigs {
        release {
            keyAlias keystoreProperties['keyAlias']
            keyPassword keystoreProperties['keyPassword']
            storeFile keystoreProperties['storeFile'] ? file(keystoreProperties['storeFile']) : null
            storePassword keystoreProperties['storePassword']
        }
    }
    
    buildTypes {
        release {
            signingConfig signingConfigs.release
        }
    }
}
```

**æ„å»ºAPK:**
```bash
# æ„å»ºdebugç‰ˆæœ¬
flutter build apk --debug

# æ„å»ºreleaseç‰ˆæœ¬
flutter build apk --release

# æ„å»ºApp Bundle (æ¨èç”¨äºGoogle Play)
flutter build appbundle --release

# åˆ†å¹³å°æ„å»º
flutter build apk --split-per-abi --release
```

### 2. iOSæ„å»º (éœ€è¦macOS)
```bash
# æ„å»ºiOSåº”ç”¨
flutter build ios --release

# ç”ŸæˆIPAæ–‡ä»¶ (éœ€è¦Xcode)
# åœ¨Xcodeä¸­æ‰“å¼€ ios/Runner.xcworkspace
# Product -> Archive -> Distribute App
```

### 3. Webæ„å»º
```bash
# æ„å»ºWebåº”ç”¨
flutter build web --release

# æœ¬åœ°æœåŠ¡å™¨æµ‹è¯•
cd build/web
python -m http.server 8000
```

## âš ï¸ å¸¸è§é—®é¢˜

### 1. ç¯å¢ƒé—®é¢˜
```bash
# Flutter doctoræ£€æŸ¥
flutter doctor -v

# æ¸…ç†é¡¹ç›®
flutter clean
flutter pub get

# å‡çº§Flutter
flutter upgrade
```

### 2. ä¾èµ–é—®é¢˜
```bash
# æ¸…ç†pubç¼“å­˜
flutter pub cache repair

# é‡æ–°è·å–ä¾èµ–
rm pubspec.lock
flutter pub get
```

### 3. æ„å»ºé—®é¢˜
```bash
# Androidæ„å»ºé—®é¢˜
cd android
./gradlew clean

# iOSæ„å»ºé—®é¢˜
cd ios
rm -rf Pods
rm Podfile.lock
pod install
```

### 4. æ€§èƒ½ä¼˜åŒ–
```dart
// ä½¿ç”¨constæ„é€ å‡½æ•°
const Text('Hello World')

// é¿å…ä¸å¿…è¦çš„buildæ–¹æ³•è°ƒç”¨
class MyWidget extends StatelessWidget {
  const MyWidget({Key? key}) : super(key: key);
  
  @override
  Widget build(BuildContext context) {
    return const Text('Optimized Widget');
  }
}

// ä½¿ç”¨ListView.builderä»£æ›¿ListView
ListView.builder(
  itemCount: items.length,
  itemBuilder: (context, index) => ItemWidget(items[index]),
)
```

## ğŸ¯ é¡¹ç›®ç‰¹è‰²æ€»ç»“

é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œä½ å°†å­¦åˆ°ï¼š

### ğŸ›  æŠ€æœ¯æŠ€èƒ½
- **Flutterå¼€å‘** - å®Œæ•´çš„ç§»åŠ¨åº”ç”¨å¼€å‘æµç¨‹
- **çŠ¶æ€ç®¡ç†** - Provideræ¨¡å¼çš„å®é™…åº”ç”¨
- **æ•°æ®åº“æ“ä½œ** - SQLiteæœ¬åœ°æ•°æ®å­˜å‚¨
- **è‡ªå®šä¹‰ç»˜åˆ¶** - Canvas APIçš„ä½¿ç”¨
- **åŠ¨ç”»æ•ˆæœ** - FlutteråŠ¨ç”»ç³»ç»Ÿ

### ğŸ¨ è®¾è®¡æŠ€èƒ½
- **UI/UXè®¾è®¡** - Material Design 3è§„èŒƒ
- **é¢œè‰²æ­é…** - æ¸å˜è‰²å½©ç³»ç»Ÿè®¾è®¡
- **å›¾æ ‡è®¾è®¡** - åº”ç”¨å›¾æ ‡çš„è®¾è®¡å’Œç”Ÿæˆ
- **åŠ¨æ•ˆè®¾è®¡** - æµç•…çš„äº¤äº’åŠ¨ç”»

### ğŸ“± äº§å“æŠ€èƒ½
- **éœ€æ±‚åˆ†æ** - å€’è®¡æ—¶åº”ç”¨çš„åŠŸèƒ½è§„åˆ’
- **ç”¨æˆ·ä½“éªŒ** - ç®€æ´ç›´è§‚çš„ç•Œé¢è®¾è®¡
- **æ€§èƒ½ä¼˜åŒ–** - åº”ç”¨æ€§èƒ½å’Œä½“éªŒä¼˜åŒ–
- **å‘å¸ƒæµç¨‹** - å®Œæ•´çš„åº”ç”¨å‘å¸ƒæµç¨‹

è¿™ä¸ªé¡¹ç›®ä¸ä»…æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„åº”ç”¨ï¼Œæ›´æ˜¯å­¦ä¹ Flutterå¼€å‘çš„ä¼˜ç§€å®è·µæ¡ˆä¾‹ã€‚å¸Œæœ›è¿™ä»½è¯¦ç»†çš„æ­å»ºæŒ‡å—èƒ½å¸®åŠ©æ‚¨å¿«é€ŸæŒæ¡Flutterå¼€å‘æŠ€èƒ½ï¼

---

**ğŸ’¡ æç¤º**: å»ºè®®æŒ‰ç…§æ–‡æ¡£é¡ºåºé€æ­¥å®ç°ï¼Œæ¯å®Œæˆä¸€ä¸ªæ¨¡å—å°±è¿›è¡Œæµ‹è¯•ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸åå†ç»§ç»­ä¸‹ä¸€æ­¥ã€‚é‡åˆ°é—®é¢˜æ—¶å¯ä»¥æŸ¥çœ‹é¡¹ç›®æºç æˆ–åœ¨GitHub Issuesä¸­å¯»æ±‚å¸®åŠ©ã€‚ 