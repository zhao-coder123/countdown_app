# ğŸ“¦ åœ†æ—¶é—´åº”ç”¨éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»å¦‚ä½•éƒ¨ç½²"åœ†æ—¶é—´"Flutteråº”ç”¨ï¼ŒåŒ…æ‹¬å®‰å“APKæ‰“åŒ…ã€iOSæ„å»ºã€Webéƒ¨ç½²ç­‰å®Œæ•´æµç¨‹ã€‚

## ğŸ“‹ ç›®å½•

- [ç¯å¢ƒå‡†å¤‡](#-ç¯å¢ƒå‡†å¤‡)
- [é¡¹ç›®é…ç½®](#-é¡¹ç›®é…ç½®)
- [å®‰å“APKæ‰“åŒ…](#-å®‰å“apkæ‰“åŒ…)
- [iOSåº”ç”¨æ„å»º](#-iosåº”ç”¨æ„å»º)
- [Webåº”ç”¨éƒ¨ç½²](#-webåº”ç”¨éƒ¨ç½²)
- [åº”ç”¨ç­¾å](#-åº”ç”¨ç­¾å)
- [åº”ç”¨å•†åº—å‘å¸ƒ](#-åº”ç”¨å•†åº—å‘å¸ƒ)
- [æŒç»­é›†æˆ](#-æŒç»­é›†æˆ)
- [é—®é¢˜æ’æŸ¥](#-é—®é¢˜æ’æŸ¥)

## ğŸ›  ç¯å¢ƒå‡†å¤‡

### 1. æ£€æŸ¥Flutterç¯å¢ƒ

```bash
# æ£€æŸ¥Flutterç¯å¢ƒçŠ¶æ€
flutter doctor -v

# ç¡®ä¿æ‰€æœ‰å¿…éœ€çš„ç»„ä»¶éƒ½å·²å®‰è£…
flutter doctor --android-licenses
```

### 2. æ›´æ–°ä¾èµ–

```bash
# æ¸…ç†é¡¹ç›®
flutter clean

# é‡æ–°è·å–ä¾èµ–
flutter pub get

# ç”Ÿæˆåº”ç”¨å›¾æ ‡
flutter pub run flutter_launcher_icons:main
```

### 3. éªŒè¯é¡¹ç›®

```bash
# è¿è¡Œè°ƒè¯•ç‰ˆæœ¬éªŒè¯åŠŸèƒ½
flutter run --debug

# è¿è¡Œå‘å¸ƒç‰ˆæœ¬æµ‹è¯•æ€§èƒ½
flutter run --release
```

## âš™ï¸ é¡¹ç›®é…ç½®

### 1. ç‰ˆæœ¬ä¿¡æ¯é…ç½®

ç¼–è¾‘ `pubspec.yaml` æ–‡ä»¶ï¼š

```yaml
name: countdown_app
description: "ç²¾ç¾çš„Flutterå€’è®¡æ—¶å’Œçºªå¿µæ—¥åº”ç”¨"
publish_to: 'none'

version: 1.0.0+1  # ç‰ˆæœ¬å·+æ„å»ºå·

environment:
  sdk: '>=3.8.0 <4.0.0'
  flutter: ">=3.32.0"
```

### 2. åº”ç”¨ä¿¡æ¯é…ç½®

**Androidé…ç½® (`android/app/build.gradle.kts`):**

```kotlin
android {
    namespace = "com.daojish.countdown_app"
    compileSdk = flutter.compileSdkVersion
    
    defaultConfig {
        applicationId = "com.daojish.countdown_app"
        minSdk = flutter.minSdkVersion
        targetSdk = flutter.targetSdkVersion
        versionCode = flutter.versionCode
        versionName = flutter.versionName
        
        // åº”ç”¨åç§°
        resValue("string", "app_name", "åœ†æ—¶é—´")
    }
}
```

**iOSé…ç½® (`ios/Runner/Info.plist`):**

```xml
<key>CFBundleDisplayName</key>
<string>åœ†æ—¶é—´</string>
<key>CFBundleName</key>
<string>countdown_app</string>
```

## ğŸ“± å®‰å“APKæ‰“åŒ…

### 1. å¿«é€Ÿæ‰“åŒ…ï¼ˆè°ƒè¯•ç‰ˆæœ¬ï¼‰

```bash
# æ„å»ºè°ƒè¯•ç‰ˆAPKï¼ˆä¸éœ€è¦ç­¾åï¼‰
flutter build apk --debug

# APKæ–‡ä»¶ä½ç½®
# build/app/outputs/flutter-apk/app-debug.apk
```

### 2. å‘å¸ƒç‰ˆæœ¬æ‰“åŒ…

#### æ­¥éª¤1ï¼šæ„å»ºå‘å¸ƒç‰ˆAPK

```bash
# æ„å»ºå‘å¸ƒç‰ˆAPKï¼ˆä½¿ç”¨è°ƒè¯•ç­¾åï¼‰
flutter build apk --release

# æ„å»ºåˆ†æ¶æ„APKï¼ˆå‡å°æ–‡ä»¶å¤§å°ï¼‰
flutter build apk --release --split-per-abi

# APKæ–‡ä»¶ä½ç½®
# build/app/outputs/flutter-apk/app-release.apk
# build/app/outputs/flutter-apk/app-arm64-v8a-release.apk
# build/app/outputs/flutter-apk/app-armeabi-v7a-release.apk
# build/app/outputs/flutter-apk/app-x86_64-release.apk
```

#### æ­¥éª¤2ï¼šæ„å»ºApp Bundleï¼ˆæ¨èï¼‰

```bash
# æ„å»ºApp Bundleï¼ˆGoogle Playæ¨èæ ¼å¼ï¼‰
flutter build appbundle --release

# AABæ–‡ä»¶ä½ç½®
# build/app/outputs/bundle/release/app-release.aab
```

### 3. æŸ¥çœ‹æ„å»ºä¿¡æ¯

```bash
# åˆ†æAPKå¤§å°
flutter build apk --analyze-size

# æŸ¥çœ‹æ„å»ºè¯¦ç»†ä¿¡æ¯
flutter build apk --release --verbose
```

### 4. æµ‹è¯•APK

```bash
# å®‰è£…APKåˆ°è¿æ¥çš„è®¾å¤‡
adb install build/app/outputs/flutter-apk/app-release.apk

# æˆ–è€…ç›´æ¥è¿è¡Œå‘å¸ƒç‰ˆæœ¬
flutter run --release
```

## ğŸ iOSåº”ç”¨æ„å»º

### 1. ç¯å¢ƒå‡†å¤‡ï¼ˆä»…macOSï¼‰

```bash
# å®‰è£…CocoaPods
sudo gem install cocoapods

# æ›´æ–°Podä¾èµ–
cd ios
pod install
cd ..
```

### 2. æ„å»ºiOSåº”ç”¨

```bash
# æ„å»ºiOSåº”ç”¨
flutter build ios --release

# æˆ–è€…æ„å»ºæ— ç­¾åç‰ˆæœ¬
flutter build ios --release --no-codesign
```

### 3. Xcodeæ„å»º

1. æ‰“å¼€ `ios/Runner.xcworkspace`
2. é€‰æ‹©æ­£ç¡®çš„Teamå’Œè¯ä¹¦
3. é€‰æ‹©ç›®æ ‡è®¾å¤‡æˆ–Generic iOS Device
4. Product â†’ Archive
5. å¯¼å‡ºIPAæ–‡ä»¶

## ğŸŒ Webåº”ç”¨éƒ¨ç½²

### 1. æ„å»ºWebåº”ç”¨

```bash
# æ„å»ºWebåº”ç”¨
flutter build web --release

# æ„å»ºå¸¦åŸºç¡€è·¯å¾„çš„Webåº”ç”¨
flutter build web --release --base-href /countdown_app/

# Webæ–‡ä»¶ä½ç½®
# build/web/
```

### 2. æœ¬åœ°æµ‹è¯•

```bash
# ä½¿ç”¨Pythonå¯åŠ¨æœ¬åœ°æœåŠ¡å™¨
cd build/web
python -m http.server 8000

# æˆ–è€…ä½¿ç”¨Node.js
npx serve -s . -p 8000
```

### 3. éƒ¨ç½²åˆ°æœåŠ¡å™¨

```bash
# å°†build/webæ–‡ä»¶å¤¹å†…å®¹ä¸Šä¼ åˆ°WebæœåŠ¡å™¨
# ç¡®ä¿æœåŠ¡å™¨æ”¯æŒSPAè·¯ç”±

# Nginxé…ç½®ç¤ºä¾‹
server {
    listen 80;
    server_name your-domain.com;
    root /path/to/build/web;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

## ğŸ” åº”ç”¨ç­¾å

### 1. ç”Ÿæˆç­¾åå¯†é’¥

```bash
# ç”Ÿæˆç­¾åå¯†é’¥ï¼ˆä»…é¦–æ¬¡ï¼‰
keytool -genkey -v -keystore ~/countdown-app-key.jks \
        -keyalg RSA -keysize 2048 -validity 10000 \
        -alias countdown-app

# ä¿å­˜å¯†é’¥ä¿¡æ¯åˆ°å®‰å…¨ä½ç½®
```

### 2. é…ç½®ç­¾å

åˆ›å»º `android/key.properties` æ–‡ä»¶ï¼š

```properties
storePassword=ä½ çš„å¯†é’¥åº“å¯†ç 
keyPassword=ä½ çš„å¯†é’¥å¯†ç 
keyAlias=countdown-app
storeFile=/path/to/countdown-app-key.jks
```

### 3. ä¿®æ”¹æ„å»ºé…ç½®

ç¼–è¾‘ `android/app/build.gradle.kts`ï¼š

```kotlin
// åœ¨androidå—å‰æ·»åŠ 
val keystoreProperties = Properties()
val keystorePropertiesFile = rootProject.file("key.properties")
if (keystorePropertiesFile.exists()) {
    keystoreProperties.load(FileInputStream(keystorePropertiesFile))
}

android {
    // ... å…¶ä»–é…ç½®

    signingConfigs {
        create("release") {
            keyAlias = keystoreProperties["keyAlias"] as String
            keyPassword = keystoreProperties["keyPassword"] as String
            storeFile = file(keystoreProperties["storeFile"] as String)
            storePassword = keystoreProperties["storePassword"] as String
        }
    }
    
    buildTypes {
        getByName("release") {
            signingConfig = signingConfigs.getByName("release")
        }
    }
}
```

### 4. æ„å»ºç­¾åç‰ˆæœ¬

```bash
# æ„å»ºç­¾åçš„å‘å¸ƒç‰ˆæœ¬
flutter build apk --release
flutter build appbundle --release
```

## ğŸª åº”ç”¨å•†åº—å‘å¸ƒ

### 1. Google Playå•†åº—

#### å‡†å¤‡æ­¥éª¤ï¼š
1. **åˆ›å»ºå¼€å‘è€…è´¦å·** - æ³¨å†ŒGoogle Playå¼€å‘è€…è´¦å·
2. **å‡†å¤‡åº”ç”¨èµ„æ–™** - å›¾æ ‡ã€æˆªå›¾ã€æè¿°ç­‰
3. **ä¸Šä¼ AABæ–‡ä»¶** - ä½¿ç”¨ `app-release.aab`

#### åº”ç”¨ä¿¡æ¯ï¼š
```
åº”ç”¨åç§°ï¼šåœ†æ—¶é—´
ç®€çŸ­æè¿°ï¼šç²¾ç¾çš„å€’è®¡æ—¶å’Œçºªå¿µæ—¥åº”ç”¨
å®Œæ•´æè¿°ï¼š
åœ†æ—¶é—´æ˜¯ä¸€æ¬¾ç°ä»£åŒ–çš„Flutterå€’è®¡æ—¶åº”ç”¨ï¼Œé‡‡ç”¨ç²¾ç¾çš„åœ†ç¯è¿›åº¦è®¾è®¡ï¼Œ
æ”¯æŒå€’è®¡æ—¶å’Œçºªå¿µæ—¥ä¸¤ç§æ¨¡å¼ã€‚è®©æ—¶é—´çš„æµé€å˜å¾—å¯è§†åŒ–å’Œæœ‰æ„ä¹‰ã€‚

ä¸»è¦åŠŸèƒ½ï¼š
â€¢ å€’è®¡æ—¶ç®¡ç† - åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å€’è®¡æ—¶äº‹ä»¶
â€¢ çºªå¿µæ—¥è®°å½• - è®°å½•é‡è¦æ—¶åˆ»ï¼Œè®¡ç®—å·²ç»è¿‡å»çš„æ—¶é—´
â€¢ ç²¾ç¾ç•Œé¢ - 10ç§æ¸å˜è‰²å½©ä¸»é¢˜ï¼Œæ·±è‰²/æµ…è‰²æ¨¡å¼
â€¢ æ™ºèƒ½ç»Ÿè®¡ - åˆ†ç±»ç®¡ç†ä¸åŒç±»å‹çš„äº‹ä»¶
â€¢ è·¨å¹³å°æ”¯æŒ - Androidã€iOSã€Webå…¨å¹³å°

åˆ†ç±»ï¼šç”Ÿæ´»æ–¹å¼
ç›®æ ‡å¹´é¾„ï¼šæ‰€æœ‰å¹´é¾„
å†…å®¹åˆ†çº§ï¼šé€‚åˆæ‰€æœ‰äºº
```

### 2. Apple App Store

#### å‡†å¤‡æ­¥éª¤ï¼š
1. **Appleå¼€å‘è€…è´¦å·** - æ³¨å†ŒAppleå¼€å‘è€…è®¡åˆ’
2. **App Store Connect** - åˆ›å»ºåº”ç”¨è®°å½•
3. **ä¸Šä¼ IPAæ–‡ä»¶** - ä½¿ç”¨Xcodeæˆ–Application Loader

## ğŸ”„ æŒç»­é›†æˆ

### 1. GitHub Actionsé…ç½®

åˆ›å»º `.github/workflows/build.yml`ï¼š

```yaml
name: Build and Release

on:
  push:
    tags:
      - 'v*'
  workflow_dispatch:

jobs:
  build-android:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-java@v3
        with:
          distribution: 'zulu'
          java-version: '17'
      - uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.32.4'
      
      - name: Get dependencies
        run: flutter pub get
        
      - name: Generate launcher icons
        run: flutter pub run flutter_launcher_icons:main
        
      - name: Build APK
        run: flutter build apk --release --split-per-abi
        
      - name: Build App Bundle
        run: flutter build appbundle --release
        
      - name: Upload artifacts
        uses: actions/upload-artifact@v3
        with:
          name: release-apk
          path: build/app/outputs/flutter-apk/
          
  build-web:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.32.4'
          
      - name: Get dependencies
        run: flutter pub get
        
      - name: Build Web
        run: flutter build web --release
        
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./build/web
```

### 2. è‡ªåŠ¨åŒ–è„šæœ¬

åˆ›å»º `scripts/build.sh`ï¼š

```bash
#!/bin/bash

echo "ğŸš€ å¼€å§‹æ„å»ºåœ†æ—¶é—´åº”ç”¨..."

# æ¸…ç†é¡¹ç›®
echo "ğŸ§¹ æ¸…ç†é¡¹ç›®..."
flutter clean

# è·å–ä¾èµ–
echo "ğŸ“¦ è·å–ä¾èµ–..."
flutter pub get

# ç”Ÿæˆå›¾æ ‡
echo "ğŸ¨ ç”Ÿæˆåº”ç”¨å›¾æ ‡..."
flutter pub run flutter_launcher_icons:main

# æ„å»ºAndroid APK
echo "ğŸ“± æ„å»ºAndroid APK..."
flutter build apk --release --split-per-abi

# æ„å»ºAndroid App Bundle
echo "ğŸ“¦ æ„å»ºAndroid App Bundle..."
flutter build appbundle --release

# æ„å»ºWebåº”ç”¨
echo "ğŸŒ æ„å»ºWebåº”ç”¨..."
flutter build web --release

echo "âœ… æ„å»ºå®Œæˆï¼"
echo "ğŸ“± APKæ–‡ä»¶: build/app/outputs/flutter-apk/"
echo "ğŸ“¦ AABæ–‡ä»¶: build/app/outputs/bundle/release/"
echo "ğŸŒ Webæ–‡ä»¶: build/web/"
```

## ğŸ” é—®é¢˜æ’æŸ¥

### 1. å¸¸è§æ„å»ºé”™è¯¯

**é”™è¯¯ï¼šGradleæ„å»ºå¤±è´¥**
```bash
# æ¸…ç†Gradleç¼“å­˜
cd android
./gradlew clean
cd ..
flutter clean
flutter pub get
```

**é”™è¯¯ï¼šä¾èµ–å†²çª**
```bash
# æ›´æ–°ä¾èµ–
flutter pub deps
flutter pub upgrade
```

**é”™è¯¯ï¼šå›¾æ ‡ç”Ÿæˆå¤±è´¥**
```bash
# æ£€æŸ¥å›¾æ ‡æ–‡ä»¶
ls -la assets/icon/
# é‡æ–°ç”Ÿæˆå›¾æ ‡
flutter pub run flutter_launcher_icons:main
```

### 2. æ€§èƒ½ä¼˜åŒ–

```bash
# æ„å»ºåˆ†æ
flutter build apk --analyze-size

# æ£€æŸ¥èµ„æºä½¿ç”¨
flutter build apk --tree-shake-icons

# å¯ç”¨æ··æ·†ï¼ˆå‡å°ä½“ç§¯ï¼‰
flutter build apk --obfuscate --split-debug-info=debug-info/
```

### 3. è°ƒè¯•å·¥å…·

```bash
# æŸ¥çœ‹æ—¥å¿—
flutter logs

# æ€§èƒ½åˆ†æ
flutter run --profile

# æ£€æŸ¥å†…å­˜ä½¿ç”¨
flutter run --trace-startup
```

## ğŸ“Š ç‰ˆæœ¬ç®¡ç†

### 1. ç‰ˆæœ¬å·è§„èŒƒ

```yaml
# pubspec.yaml
version: 1.0.0+1
#        â†‘   â†‘
#        |   æ„å»ºå·ï¼ˆæ¯æ¬¡æ„å»ºé€’å¢ï¼‰
#        ç‰ˆæœ¬å·ï¼ˆä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.è¡¥ä¸ç‰ˆæœ¬ï¼‰
```

### 2. å‘å¸ƒæ£€æŸ¥æ¸…å•

- [ ] åŠŸèƒ½æµ‹è¯•å®Œæˆ
- [ ] UIé€‚é…éªŒè¯
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] ç‰ˆæœ¬å·å·²æ›´æ–°
- [ ] æ›´æ–°æ—¥å¿—å·²ç¼–å†™
- [ ] åº”ç”¨å›¾æ ‡å·²ç”Ÿæˆ
- [ ] ç­¾åé…ç½®æ­£ç¡®
- [ ] éšç§æ”¿ç­–å·²æ›´æ–°

### 3. å‘å¸ƒå‘½ä»¤

```bash
# åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0

# æ„å»ºæœ€ç»ˆç‰ˆæœ¬
./scripts/build.sh

# éªŒè¯æ„å»ºäº§ç‰©
ls -la build/app/outputs/flutter-apk/
ls -la build/app/outputs/bundle/release/
```

---

## ğŸ¯ å¿«é€Ÿæ‰“åŒ…å‘½ä»¤

å¦‚æœä½ åªæ˜¯æƒ³å¿«é€Ÿæ‰“åŒ…ä¸€ä¸ªAPKè¿›è¡Œæµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# ä¸€é”®æ‰“åŒ…å‘å¸ƒç‰ˆAPK
flutter build apk --release

# APKæ–‡ä»¶ä½ç½®ï¼šbuild/app/outputs/flutter-apk/app-release.apk
```

è¿™ä¸ªAPKå¯ä»¥ç›´æ¥å®‰è£…åˆ°Androidè®¾å¤‡ä¸Šè¿›è¡Œæµ‹è¯•ã€‚å¦‚æœéœ€è¦ä¸Šä¼ åˆ°åº”ç”¨å•†åº—ï¼Œå»ºè®®ä½¿ç”¨App Bundleæ ¼å¼ï¼š

```bash
# æ‰“åŒ…App Bundle
flutter build appbundle --release

# AABæ–‡ä»¶ä½ç½®ï¼šbuild/app/outputs/bundle/release/app-release.aab
```

**æ³¨æ„ï¼š** å‘å¸ƒåˆ°Google Playå•†åº—éœ€è¦ä½¿ç”¨æ­£å¼çš„ç­¾åå¯†é’¥ï¼Œä¸Šè¿°å‘½ä»¤ä½¿ç”¨çš„æ˜¯è°ƒè¯•ç­¾åï¼Œä»…é€‚ç”¨äºæµ‹è¯•ã€‚

ç¥ä½ æ‰“åŒ…é¡ºåˆ©ï¼ğŸ‰ 